#include "laa_math.h"

uint16_t isin[] = {
0, 571, 1143, 1715, 2286, 2858, 3429, 4000, 4571, 5141, 5711, 6280, 6849, 7418, 7986, 8553, 9120, 9686, 10251, 10816, 
11379, 11942, 12504, 13065, 13625, 14184, 14741, 15298, 15854, 16408, 16961, 17513, 18063, 18612, 19160, 19706, 20251, 20794, 21335, 21875, 
22414, 22950, 23485, 24018, 24549, 25079, 25606, 26131, 26655, 27176, 27696, 28213, 28728, 29241, 29752, 30260, 30766, 31270, 31771, 32270, 
32767, 33261, 33753, 34241, 34728, 35211, 35692, 36171, 36646, 37119, 37589, 38056, 38520, 38981, 39440, 39895, 40347, 40796, 41242, 41685, 
42125, 42561, 42994, 43424, 43851, 44274, 44694, 45111, 45524, 45934, 46340, 46743, 47142, 47537, 47929, 48317, 48702, 49083, 49460, 49833, 
50202, 50568, 50930, 51288, 51642, 51992, 52338, 52681, 53019, 53353, 53683, 54009, 54331, 54649, 54962, 55272, 55577, 55878, 56174, 56467, 
56755, 57039, 57318, 57593, 57864, 58130, 58392, 58649, 58902, 59151, 59395, 59634, 59869, 60099, 60325, 60546, 60763, 60975, 61182, 61385, 
61583, 61776, 61965, 62148, 62327, 62502, 62671, 62836, 62996, 63151, 63302, 63448, 63588, 63724, 63855, 63982, 64103, 64219, 64331, 64438, 
64539, 64636, 64728, 64815, 64897, 64974, 65047, 65114, 65176, 65233, 65286, 65333, 65375, 65413, 65445, 65473, 65495, 65513, 65525, 65533, 
65535};

int16_t sin_koef(int16_t r, int16_t a) { // 0.5 deg
  while (a > 720) a -= 360*2;
  while (a < 0) a += 360*2;
  uint8_t neg;
  if (a <= 90*2) {
    neg = 0;
  } else if (a <= 180*2) {
    a = 180*2 - a;
    neg = 0;
  } else if (a <= 270*2) {
    a = a - 180*2;
    neg = 1;
  } else {
    a = 360*2 - a;
    neg = 1;
  }  
  if (r < 0) {
    r = -r;
    neg = !neg;
  }  
  uint32_t mul = isin[a];
  if (mul == 1) mul = 0;
  uint32_t res = r * mul;
  if (neg)
    return -(int16_t)(res >> 16);
  else
    return (int16_t)(res >> 16);
}  

int16_t cos_koef(int16_t r, int16_t a) { // 0.5 deg
  return sin_koef(r, 450*2 - a);
}  
